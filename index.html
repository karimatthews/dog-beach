<html>
    <head>
       <style>
           #gameCanvas {
               background-color: darkcyan;
               border: 1px solid black;
           }
       </style>
    </head>
    <body>
        <canvas id="gameCanvas" width="800" height="500">

        </canvas>
        <script>

            var canvas = document.getElementById("gameCanvas")
            var ctx = canvas.getContext("2d");

            var player = {
                x: 10,
                y: 10,
                dx: 0,
                dy: 0,
                width: 20,
                height: 20
            }

            var solidObjects = []
            function  buildSolidObject(type, x, y, width, height) {
               var obj = {
                   type: type,
                   x: x,
                   y: y,
                   width: width,
                   height: height
               }
               solidObjects.push(obj)
            }

            buildSolidObject('tree', 100, 100, 20, 20)

            function drawWorld() {
                ctx.clearRect(0, 0, canvas.width, canvas.height)
                ctx.fillStyle = "#FF0000";
                ctx.fillRect(player.x, player.y, player.width, player.height);
                ctx.fillStyle = "#0a250e";
                solidObjects.forEach(drawObject)
                window.requestAnimationFrame(drawWorld)
            }

            function drawObject(solidObject) {
                ctx.fillRect(solidObject.x, solidObject.y, solidObject.width, solidObject.height);
            }

            function tick() {
                movePlayerVertically()
                movePlayerHorizontally()
            }

            function movePlayerVertically() {
                if (playerAvoidsVerticalBoundary()&& playerAvoidsObjects()) {
                    player.y += player.dy;
                }
            }

            function movePlayerHorizontally() {
                if (playerAvoidsHorizontalBoundary() && playerAvoidsObjects()) {
                    player.x += player.dx;
                }
            }

            function playerAvoidsObjects() {
                var avoids = true
                solidObjects.forEach(function(obj) {
                    if (overlap(obj)) { avoids = false }
                })
                return avoids
            }

            function overlap(solidObject) {
                return (verticalOverlap(solidObject) && horizontalOverlap(solidObject))
            }


            function horizontalOverlap(solidObject) {
                var right = (player.x + player.dx + player.width) <= (solidObject.x + solidObject.width + player.width)
                var left = (solidObject.x - player.width) <= (player.x + player.dx)
                return right && left
            }

            function verticalOverlap(solidObject) {
                var bottom = (player.y + player.dy + player.height) <= (solidObject.y + solidObject.height + player.height)
                var top = (solidObject.y - player.height) <= (player.y + player.dy)
                return bottom && top
            }

            function playerAvoidsVerticalBoundary() {
                return (0 < player.y +player.dy) && (player.y + player.dy < canvas.height - player.height)
            }

            function playerAvoidsHorizontalBoundary() {
                return (0 < player.x + player.dx) && (player.x + player.dx < canvas.width - player.width)
            }

            document.addEventListener("keydown", function(e) {
                if (e.keyCode === 38) {
                    //up arrow
                    player.dy = -1
                }
                if (e.keyCode === 40) {
                    //down arrow
                    player.dy = 1
                }
                if (e.keyCode === 37) {
                    //left arrow
                    player.dx = -1
                }
                if (e.keyCode === 39) {
                    //right arrow
                    player.dx = 1
                }
            });

            document.addEventListener("keyup", function(e) {

                if ([38, 40, 37, 39].indexOf(e.keyCode) !== -1) {
                    player.dx = 0;
                    player.dy = 0;
                }

            });
            setInterval(tick, 5);
            drawWorld()
        </script>
    </body>
</html>